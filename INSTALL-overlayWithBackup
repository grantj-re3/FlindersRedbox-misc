1. APPLICATION ENVIRONMENT

See INSTALL-overlayPrep.


2. INSTALLATION

See INSTALL-overlayPrep.


3. EXAMPLES


3.1 EXAMPLE INVOCATIONS

Command line invocation.
  overlayWithBackup.sh overlayWithBackup.sh  BASEPATH [ 2>&1 |tee logYYMMDD_HHMM ]

    where BASEPATH.tgz contains the files to overlay (and may also contain
      other files which will not be overlaid using this program)
    and BASEPATH.list.x gives the user-edited list of files/dirs to be
      overlaid.  These files shall be backed up before before a new version
      is overlaid. These files must exist within BASEPATH.tgz.


3.2 SAMPLE INSTALLATION

The purpose of this sample is to demonstrate usage.


Scenario:

 - This application to be installed in $HOME/opt/misc of an unprivileged user.
 - The backup and other files generated by the previously run
   overlayPrep.sh (backup) script were written to directory:
     $HOME/backup/overlay/ands_140210.150710

Instructions:

  mkdir ~/opt
  git clone https://github.com/grantj-re3/FlindersRedbox-misc.git ~/opt/misc
  cd ~/opt/misc

# If you want a particular version
  git tag # List tagged releases
  git checkout ... # Checkout the desired release

# Read files INSTALL LICENSE README*

# 1) It is not expected that you will need to edit any environment variables
#    within bin/overlayWithBackup.sh

# 2) Backup the part of the filesystem being overlaid/reinstated if you wish.

# 3) View the usage info
  bin/overlayWithBackup.sh

# 4) Make a copy of those files and directories which were previously
#    backed up.
  cd ~/backup/overlay/ands_140210.150710
  cp -vip overlay_redbox.list overlay_redbox.list.x

# 5) Edit overlay_redbox.list.x to remove all paths except those which you
#    wish to overlay/reinstate

# 6) Change directory so that the current working directory is where the
#    tarball files (and files listed in overlay_redbox.list.x) were created.
  cd TOP_OF_TAR_BACKUP

# 7) Overlay/reinstate the files.
#    Note that argument BASEPATH does not correspond to any file, but
#    BASEPATH.list.x and BASEPATH.tgz must exist.
  ~/opt/misc/bin/overlayWithBackup.sh ~/backup/overlay/ands_140210.150710/overlay_redbox 2>&1 |tee ~/tmp/logYYMMYY

#    If all the info looks ok, press 'y' then Enter

# Terms used:
# - "Target file" below means a file in the filesystem (not in the
#   tarball) listed in BASEPATH.list.x.
#
# - "Symlink-target" below means a file/dir pointed to by a symlink.
#
# Notes:
# - If any of the (selected) files from the tarball is a
#   symlink, after running overlayWithBackup.sh the target file
#   in the filesystem will also be a symlink.
#
# - If any of the (selected) target files in the filesystem is a symlink,
#   after running overlayWithBackup.sh the target file will have been
#   replaced with the file (symlink or not) from the tarball (and the
#   original symlink-target will not be affected).
#
# These properties result from the normal behaviour of (GNU) tar.

# 8) Celebrate!

